

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>dmft cycle module &mdash; solid_dmft  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="dmft tools modules" href="dmft_tools.html" />
    <link rel="prev" title="vasp_manager.py" href="dft_managers/vasp_manager.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >
          

          
            <a href="../index.html" class="icon icon-home"> solid_dmft
          

          
            
            <img src="../_static/logo_no_text.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">install</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#version-compatibility">Version compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../documentation.html">documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../documentation.html#module-reference-manual">module reference manual</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="csc_flow.html">CSC flow module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dft_managers.html">dft managers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dft_managers/qe_manager.html">qe_manager.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="dft_managers/vasp_manager.html">vasp_manager.py</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">dmft cycle module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dmft_tools.html">dmft tools modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dmft_tools/afm_mapping.html">afm_mapping.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="dmft_tools/convergence.html">convergence.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="dmft_tools/formatter.html">formatter.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="dmft_tools/gf_mixer.html">greens_function_mixer.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="dmft_tools/initial_sigma.html">initial_self_energies.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="dmft_tools/interaction_ham.html">interaction_hamiltonian.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="dmft_tools/legendre_filter.html">legendre_filter.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="dmft_tools/manipulate_mu.html">manipulate_chemical_potential.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="dmft_tools/observables.html">observables.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="dmft_tools/results_arch.html">results_to_archive.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="dmft_tools/solver.html">solver.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="postprocessing.html">postprocessing tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="postprocessing/make_spaghetti.html">make_spaghetti.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing/maxent_gf_imp.html">maxent_gf_imp.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing/maxent_gf_latt.html">maxent_gf_latt.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing/maxent_sigma.html">maxent_sigma.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing/postproc_plotbands.html">postproc_plotbands.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="read_config.html">read config parser</a><ul>
<li class="toctree-l4"><a class="reference internal" href="read_config.html#general">general</a></li>
<li class="toctree-l4"><a class="reference internal" href="read_config.html#solver">solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="read_config.html#dft">dft</a></li>
<li class="toctree-l4"><a class="reference internal" href="read_config.html#advanced">advanced</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="util.html">util</a><ul>
<li class="toctree-l4"><a class="reference internal" href="util/symmetrize_gamma_file.html">symmetrize_gamma_file.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="util/update_dmft_config.html">update_dmft_config.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="util/update_results_h5.html">update_results_h5.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="util/write_kslice_to_h5.html">write_kslice_to_h5.py</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#dft-code-interfaces">DFT code interfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../md_notes/w90_interface.html">Wannier90 interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/w90_interface.html#orbital-order-in-the-w90-converter">orbital order in the W90 converter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../md_notes/vasp_csc.html">interface to VASP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/vasp_csc.html#general-remarks">General remarks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/vasp_csc.html#locproj-bug-for-individual-projections">LOCPROJ bug for individual projections:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/vasp_csc.html#convergence-of-projectors-with-vasp">convergence of projectors with Vasp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/vasp_csc.html#enabling-csc-calculations-with-wannier90-projectors">Enabling CSC calculations with Wannier90 projectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/vasp_csc.html#speeding-up-by-not-writing-projectors-at-every-step">Speeding up by not writing projectors at every step</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#run-solid-dmft">run solid_dmft</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../md_notes/docker.html">Docker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/docker.html#building-the-docker-image">Building the docker image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/docker.html#pulling-a-docker-image">Pulling a docker image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/docker.html#getting-docker-images-onto-cscs-daint">Getting docker images onto CSCS daint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/docker.html#running-a-docker-container">Running a docker container</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../md_notes/run_locally.html">run on your machine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/run_locally.html#csc-calculations-locally">CSC calculations locally</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../md_notes/run_cluster.html">Running solid_dmft on a cluster</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/run_cluster.html#running-on-cscs-daint">Running on CSCS daint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/run_cluster.html#one-shot-job-on-daint">one shot job on daint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../md_notes/run_cluster.html#csc-calculations-on-daint">CSC calculations on daint</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/CaFeO3_csc_plo/tutorial.html">CaFeO3 CSC with VASP PLOs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/CaFeO3_csc_plo/tutorial.html#Running-the-initial-SCF-DFT-calculation-(~-1-core-hour)">Running the initial SCF DFT calculation (~ 1 core hour)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/CaFeO3_csc_plo/tutorial.html#Input-files-for-CSC-DMFT-calculations">Input files for CSC DMFT calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/CaFeO3_csc_plo/tutorial.html#Running-the-CSC-DMFT-calculations">Running the CSC DMFT calculations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-3-0-0">Version 3.0.0</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">solid_dmft</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../documentation.html">documentation</a> &raquo;</li>
        
      <li>dmft cycle module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/reference/dmft_cycle.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-solid_dmft.dmft_cycle">
<span id="dmft-cycle-module"></span><h1>dmft cycle module<a class="headerlink" href="#module-solid_dmft.dmft_cycle" title="Permalink to this headline">¶</a></h1>
<p>Defines the dmft_cycle which works for one-shot and csc equally</p>
<dl class="py function">
<dt class="sig sig-object py" id="solid_dmft.dmft_cycle._calculate_rotation_matrix">
<code class="sig-prename descclassname"><span class="pre">solid_dmft.dmft_cycle.</span></code><code class="sig-name descname"><span class="pre">_calculate_rotation_matrix</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">general_params</span></span></em>, <em><span class="n"><span class="pre">sum_k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solid_dmft/dmft_cycle.html#_calculate_rotation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solid_dmft.dmft_cycle._calculate_rotation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies rotation matrix to make the DMFT calculations easier for the solver.
Possible are rotations diagonalizing either the local Hamiltonian or the
density. Diagonalizing the density has not proven really helpful but
diagonalizing the local Hamiltonian has.
In the current implementation, this cannot be used when there is a
non-identity rot_mat already as for example done by the Wannier90 converter.
Note that the interaction Hamiltonian has to be rotated if it is not fully
orbital-gauge invariant (only the Kanamori fulfills that).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solid_dmft.dmft_cycle._chi_SzSz_setup">
<code class="sig-prename descclassname"><span class="pre">solid_dmft.dmft_cycle.</span></code><code class="sig-name descname"><span class="pre">_chi_SzSz_setup</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">sum_k</span></span></em>, <em><span class="n"><span class="pre">general_params</span></span></em>, <em><span class="n"><span class="pre">solver_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solid_dmft/dmft_cycle.html#_chi_SzSz_setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solid_dmft.dmft_cycle._chi_SzSz_setup" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>sum_k</strong> : SumkDFT object</p>
<blockquote>
<div><p>Sumk object with the information about the correct block structure</p>
</div></blockquote>
<p><strong>general_paramters: general params dict</strong> :</p>
<p><strong>solver_params: solver params dict</strong> :</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>solver_params</strong> :  dict</p>
<blockquote>
<div><p>solver_paramters for the QMC solver</p>
</div></blockquote>
<p class="last"><strong>Sz_list</strong> : list of S_op operators to measure per impurity</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solid_dmft.dmft_cycle._determine_block_structure">
<code class="sig-prename descclassname"><span class="pre">solid_dmft.dmft_cycle.</span></code><code class="sig-name descname"><span class="pre">_determine_block_structure</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">sum_k</span></span></em>, <em><span class="n"><span class="pre">general_params</span></span></em>, <em><span class="n"><span class="pre">advanced_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solid_dmft/dmft_cycle.html#_determine_block_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solid_dmft.dmft_cycle._determine_block_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines block structrure and degenerate deg_shells
computes first DFT density matrix to determine block structure and changes
the density matrix according to needs i.e. magnetic calculations, or keep
off-diag elements</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>sum_k</strong> : SumK Object instances</p>
<p><strong>__Returns:__</strong> :</p>
<p><strong>sum_k</strong> : SumK Object instances</p>
<blockquote class="last">
<div><p>updated sum_k Object</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solid_dmft.dmft_cycle._dmft_step">
<code class="sig-prename descclassname"><span class="pre">solid_dmft.dmft_cycle.</span></code><code class="sig-name descname"><span class="pre">_dmft_step</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">sum_k</span></span></em>, <em><span class="n"><span class="pre">solvers</span></span></em>, <em><span class="n"><span class="pre">it</span></span></em>, <em><span class="n"><span class="pre">general_params</span></span></em>, <em><span class="n"><span class="pre">solver_params</span></span></em>, <em><span class="n"><span class="pre">advanced_params</span></span></em>, <em><span class="n"><span class="pre">dft_params</span></span></em>, <em><span class="n"><span class="pre">h_int</span></span></em>, <em><span class="n"><span class="pre">archive</span></span></em>, <em><span class="n"><span class="pre">shell_multiplicity</span></span></em>, <em><span class="n"><span class="pre">E_kin_dft</span></span></em>, <em><span class="n"><span class="pre">observables</span></span></em>, <em><span class="n"><span class="pre">conv_obs</span></span></em>, <em><span class="n"><span class="pre">Sz_list</span></span></em>, <em><span class="n"><span class="pre">dft_irred_kpt_indices</span></span></em>, <em><span class="n"><span class="pre">dft_energy</span></span></em>, <em><span class="n"><span class="pre">is_converged</span></span></em>, <em><span class="n"><span class="pre">is_sampling</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solid_dmft/dmft_cycle.html#_dmft_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solid_dmft.dmft_cycle._dmft_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the actual dmft steps when all the preparation is done</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="solid_dmft.dmft_cycle.dmft_cycle">
<code class="sig-prename descclassname"><span class="pre">solid_dmft.dmft_cycle.</span></code><code class="sig-name descname"><span class="pre">dmft_cycle</span></code><span class="sig-paren">(</span><em><span class="n"><span class="pre">general_params</span></span></em>, <em><span class="n"><span class="pre">solver_params</span></span></em>, <em><span class="n"><span class="pre">advanced_params</span></span></em>, <em><span class="n"><span class="pre">dft_params</span></span></em>, <em><span class="n"><span class="pre">n_iter</span></span></em>, <em><span class="n"><span class="pre">dft_irred_kpt_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em><span class="n"><span class="pre">dft_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solid_dmft/dmft_cycle.html#dmft_cycle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#solid_dmft.dmft_cycle.dmft_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>main dmft cycle that works for one shot and CSC equally</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>general_params</strong> : dict</p>
<blockquote>
<div><p>general parameters as a dict</p>
</div></blockquote>
<p><strong>solver_params</strong> : dict</p>
<blockquote>
<div><p>solver parameters as a dict</p>
</div></blockquote>
<p><strong>advanced_params</strong> : dict</p>
<blockquote>
<div><p>advanced parameters as a dict</p>
</div></blockquote>
<p><strong>observables</strong> : dict</p>
<blockquote>
<div><p>current observable array for calculation</p>
</div></blockquote>
<p><strong>n_iter</strong> : int</p>
<blockquote>
<div><p>number of iterations to be executed</p>
</div></blockquote>
<p><strong>dft_irred_kpt_indices: iterable of int</strong> :</p>
<blockquote>
<div><p>If given, writes density correction for csc calculations only for
irreducible kpoints</p>
</div></blockquote>
<p><strong>__Returns:__</strong> :</p>
<p><strong>observables</strong> : dict</p>
<blockquote class="last">
<div><p>updated observable array for calculation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="dmft_tools.html" class="btn btn-neutral float-right" title="dmft tools modules" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="dft_managers/vasp_manager.html" class="btn btn-neutral float-left" title="vasp_manager.py" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Copyright (C) 2018-2020, ETH Zurich Copyright (C) 2021, The Simons Foundation authors: A. Hampel, M. Merkel, and S. Beck.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>